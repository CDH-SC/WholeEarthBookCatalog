<link rel="import" href="../bower_components/polymer/polymer-element.html">
<link rel="import" href="../bower_components/paper-input/paper-input.html">
<link rel="import" href="../bower_components/paper-button/paper-button.html">
<link rel="import" href="../bower_components/iron-icons/iron-icons.html">
<link rel="import" href="frag-footer.html">
<link rel="import" href="shared-styles.html">

<dom-module id="dhc-book-results">
    <template>
        <style include=" shared-styles iron-flex iron-flex-alignment">
            .container {
                @apply --layout-horizontal;
            }

            #result-entry-wrapper {
                width: 100%;
                height: calc(100% - 60px);
                overflow:scroll;
            }

            .result-item-info {
                height: 250px;
                display: flex; /*relate to container element*/
                border: 1px solid grey;
            }

            #result-item-image {
                margin-left: 50px;
                margin-top: 20px;
                width: 140px;
                height: 200px;
            }

            #result-item-menu {
                width: 20%;
                height: 100%;
                border: 1px solid grey;
                display: flex;
                flex-direction: column;
                border-top:none;
                border-bottom:none;
            }

            #result-item-view-profile {
                width: 100%;
                height: 33.3%;
                padding:0px;
                border-top: none;
            }

            #result-item-request {
                padding:0px;
                width: 50%;
                height: 33.3%;
            }

            #result-paired-buttons {
                display: flex;
            }

            #result-item-like {
                padding: 0px;
                width: 50%;
                height: 33.3%;
            }

            #result-item-share {
                width: 100%;
                height: 34%;
                border-top: none;
            }

            .paper-metadata {
                flex-grow: 1;
                margin-left: 50px;
                display: flex;
                flex-direction: column;
                justify-content: center;
            }

            .paper-metadata > h2{
                margin: 0px;
            }

            .paper-metadata > h4{
                margin: 0px;
            }

            paper-button {
                margin: 0px;
                box-shadow: none;
                border: 1px solid grey;
            }
        </style>

        <app-route
            route="{{route}}"
            pattern="/:search"
            data="{{routeData}}">
        </app-route>
        
        <template is="dom-if" if="{{!searchDataLoaded}}">
            Loading...
        </template>
        
        <template is="dom-if" if="{{searchDataLoaded}}">
                    <div id = "result-entry-wrapper" class="border-color">
            <template is="dom-repeat" items="[[searchdata.data.records]]">
                <div class="result-item-info border-color">
                    <image id = "result-item-image" class="border-color" src= "../images/clockwork_small.jpg"></image>
    
                    <paper-dialog class = "paper-metadata border-color">
                        <h2>{{item.name}}</h2> 
                        <h4>{{item.author}}</h4> 
                        <h4> Genres: 
                            <template is="dom-repeat" items="[[item.genres]]" as="genre">
                                {{genre}}
                            </template>
                        </h4>
                        <h4> Publisher: {{item.publisher}}</h4> 
                        <h4> Originally Published: {{item.year}} </h4>
                    </paper-dialog>
    
                    <div id = "result-item-menu" class="border-color">
                        <a href="/book-profile/{{item.name}}">
                            <paper-button on-click="" id = "result-item-view-profile" class="border-color"> View Profile </paper-button> 
                        </a>
                        <div id = "result-paired-buttons"> 
                            <paper-button id = "result-item-request" class="border-color"> Request </paper-button>
                            <paper-button id = "result-item-like" title = "heart" id = "result-item-like" class="border-color"> Like </paper-button> 
                        </div>
    
                        <paper-button id = "result-item-share" class="border-color"> 
                            Share
                        </paper-button>
                    </div>
                </div>
            </template>
        </div>
    </template>

        <frag-footer> </frag-footer>
    </template>
    <script>
        class dhcBookResults extends Polymer.Element {
            static get is() { return 'dhc-book-results'; }
            static get ready() {
                console.log("Getting read");

                console.log(this.searchData);
            }
            static get properties() {
                return {
                    rootPath: String,
                    search: {
                        type: String,
                        value: "HI"
                    },
                    searchdata: {
                        type: Object,
                        observer: "_searchDataObserver"
                    },
                    searchDataLoaded: {
                        type: Boolean,
                        value: false
                    }
                }
            }

            _searchDataObserver() {
                console.log(this.searchdata);
                console.log("in here");
                this.set('searchDataLoaded', true);
            }
        }
        window.customElements.define(dhcBookResults.is, dhcBookResults);
    </script>
</dom-module>

