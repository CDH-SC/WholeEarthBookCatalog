<link rel="import" href="../bower_components/polymer/polymer-element.html">
<link rel="import" href="../bower_components/app-storage/app-localstorage/app-localstorage-document.html">

<script type="text/javascript" src="https://d3js.org/d3.v4.min.js"></script>

<dom-module id="loading-graphic">
    <template>
        <style include = "shared-styles.html"> 

        #d3-graph:-webkit-full-screen {

        }

        #d3-graph:-moz-full-screen {

        }

        #d3-graph:-ms-full-screen {
            
        }

        #d3-graph-container {

        }

        #d3-graph-header {

        }

        #d3-graph-header-span {
            
        }

        #widget {
            position: relative;
            height: auto;
            
        }

        #widget.hidden {
            display: none;
        }

        #widget p {
            margin:0;
            line-height: 20px;
        }

         

     </style>
     <svg width = "" height = ""></svg> 

    <script>

        var svg = d3.select("svg"),
            width = +svg.attr("width"),
            height = +svg.attr("height");

        var colorScheme = d3.scaleOrdinal(d3.schemeCategory20b);

        var simulation = d3.forceSimulation()
            /*.force("link", d3.forceLink().id(function(d) {
                return d.id;
            })) */
            .force("generalForce", d3.forceManyBody())
            .force("center", d3.forceCenter(width/2, height/2));

        d3.json("wcImport", function(error, graph) {
            if(error) throw error;

           /* var edge = svg.append("g")
                .attr("class", "links")
                .selectAll("line")
                .data(graph.links)
                .enter().append("line")
                .attr("stroke-width", function(d) {
                    return Math.sqrt(d.value);
                }) */

            var node = svg.append("g")
                .attr("class", "nodes")
                .selectAll("circle")
                .data(graph.nodes)
                .enter().append("circle")
                .attr("r", 5)
                .attr("fill", function(d) {
                    return color(d.group);
                }) 

                node.append("title")
                    .text(function(d) {
                        return d.title;
                    });
                
                /*
                .call(d3.drag()
                    .on("start", dragstarted)
                    .on("drag", dragged)
                    .on("end", dragended)
                );   */

            simulation 
                .nodes(graph.nodes)
                .on("tick", iter)
                .on("mouseover", function(d) {
                    var xpos = d3.select(this).attr("cx");
                    var ypos = d3.select(this).attr("cy");

                    d3.select("#widget")
                        .select("#value")
                        .text(d);
                });

            simulation.force("node") 
                .nodes(graph.nodes);

            function iter() {
                node 
                    .attr("cx", function(d) {
                        return d.x;
                    })
                    .attr("cy", function(d) {
                        return d.y;
                    });
                }
        });

 </script>


</dom-module>