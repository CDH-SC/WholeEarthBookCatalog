<link rel="import" href="../bower_components/polymer/polymer-element.html">
<link rel="import" href="../bower_components/app-storage/app-localstorage/app-localstorage-document.html">
<link rel="import" href="d3-import.html">

<dom-module id="dhc-loading-graphic">
    <template>
        <style include = "shared-styles.html"> 

        #d3-graph:-webkit-full-screen {

        }

        #d3-graph:-moz-full-screen {

        }

        #d3-graph:-ms-full-screen {
            
        }

        #d3-graph-container {

        }

        #d3-graph-header {

        }

        #d3-graph-header-span {
            
        }

        .nodes circle {

        }


     </style>
     <template>
        <svg width = "" height = ""></svg> 
     </template>

    <script>
        var svg = d3.select("svg"),
            width = +svg.attr("width"),
            height = +svg.attr("height");

        var colorScheme = d3.scaleOrdinal(d3.schemeCategory20b);

        var simulation = d3.forceSimulation()

        .force("generalForce", d3.forceManyBody())
            .force("center", d3.forceCenter(width / 2, height / 2));

        d3.json("wcImport", function(error, graph) {
            if (error) throw error;

            var node = svg.append("g")
                .attr("class", "nodes")
                .selectAll("circle")
                .data(graph.nodes)
                .enter().append("circle")
                .attr("r", 5)
                .attr("fill", function(d) {
                    return color(d.group);
                })


            .on("onmouseover").enter().append("text")
                .attr("text", function(d) {
                    return d;
                });

            node.append("title")
                .text(function(d) {
                    return d.title;
                });

            simulation
                .nodes(graph.nodes)
                .on("motion", motionIter);

            simulation.force("node")
                .nodes(graph.nodes);

            function motionIter() {
                node
                    .attr("cx", function(d) {
                        return d.x;
                    })
                    .attr("cy", function(d) {
                        return d.y;
                    });
            }
        })


        function startDrag() {
            if (!d3.event.active) simulation.alphaTarget(0.3).restart();
            d.dx = d.x;
            d.fy = d.y;
        }

        function drag() {
            d.fx = d3.event.x;
            d.fy = d3.event.y;
        }

        function endDrag() {
            if (!d3.event.active) simulation.alphaTarget(0.01);
            d.fx = null;
            d.fy = null;

        }
    </script>
</dom-module>